slam_toolbox:
  ros__parameters:
    use_sim_time: true

    # === 루프클로저 완화 ===
    loop_search_maximum_distance: 1.5
    loop_closure_threshold: 0.95
    loop_search_space: "search_ring"

    minimum_travel_distance: 0.05   # 5cm 이동 시 갱신
    minimum_travel_heading: 0.05    # 3도 회전 시 갱신
    
    # ================================================
    # 4. 기타 센서 설정
    # ================================================
    # 시뮬레이션에서 IMU가 종종 맵을 터뜨리므로 끄는 게 더 안정적일 때가 많음
    use_imu: true
    
    max_laser_range: 3.5
    resolution: 0.05
    
    # 오도메트리 오차가 커졌을 때 패널티를 세게 줌 (강제로 오도메트리 위치 고수)
    distance_variance_penalty: 0.5  
    angle_variance_penalty: 1.0    

    # Scan Matcher 방식 설정 (Ceres Solver가 더 정밀하지만 무거움, 여기선 기본 사용)
    solver_plugin: solver_plugins::CeresSolver
    ceres_linear_solver: SPARSE_NORMAL_CHOLESKY
    ceres_preconditioner: JACOBI
    ceres_trust_strategy: LEVENBERG_MARQUARDT
